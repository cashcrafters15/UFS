<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Joining Form | Unified Security</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* --- INLINE CSS --- */
body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#f8fafc;color:#333;padding-bottom:80px;position:relative;overflow-x:hidden;}
.navbar{background:rgba(0,51,102,0.95);padding:10px 0;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
.navbar-brand{color:white!important;font-weight:700;display:flex;align-items:center;}
.brand-text{margin-left:12px;text-transform:uppercase;letter-spacing:0.5px;font-size:1.1rem;}
.main-wrapper{padding-top:100px;}
.paper-card{background:white;max-width:1000px;margin:0 auto;box-shadow:0 10px 40px rgba(0,0,0,0.08);padding:50px;border:1px solid #eee;border-radius:10px;}
.paper-header{text-align:center;border-bottom:3px solid #003366;padding-bottom:25px;margin-bottom:40px;}
.paper-header h2{color:#003366;font-weight:800;text-transform:uppercase;font-size:1.6rem;margin-bottom:8px;}
.paper-header h5{text-transform:uppercase;font-weight:600;color:#444;letter-spacing:1px;}
.asterisk{font-size:0.9rem;color:#666;margin-top:5px;}
.form-label-bold{font-weight:600;font-size:0.95rem;margin-bottom:6px;color:#2c3e50;display:block;}
.paper-input{width:100%;border:1px solid #d1d5db;padding:10px 12px;border-radius:6px;background:#f9fafb;font-size:0.95rem;transition: all 0.3s ease;}
.paper-input:focus{outline:none;border-color:#003366;background:#fff;box-shadow:0 0 0 3px rgba(0,51,102,0.1);}
.paper-textarea{width:100%;border:1px solid #d1d5db;padding:10px 12px;border-radius:6px;background:#f9fafb;resize:vertical;}
.photo-upload-box{width:100%;height:180px;border:2px dashed #cbd5e1;border-radius:8px;background:#f8fafc;overflow:hidden;position:relative;transition:border-color 0.3s;}
.photo-upload-box:hover{border-color:#003366;}
.photo-placeholder{height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;cursor:pointer;color:#94a3b8;}
.photo-placeholder:hover{color:#003366;}
.table-responsive{margin-top:15px;}
.paper-table{width:100%;border-collapse:separate;border-spacing:0;font-size:0.9rem;box-shadow:0 0 0 1px #e2e8f0;border-radius:6px;overflow:hidden;}
.paper-table th{background:#003366;color:white;padding:12px;text-align:center;font-weight:600;text-transform:uppercase;font-size:0.8rem;letter-spacing:0.5px;}
.paper-table td{border-bottom:1px solid #e2e8f0;border-right:1px solid #e2e8f0;padding:10px;background:white;vertical-align:middle;}
.paper-table td:last-child{border-right:none;}
.paper-table tr:last-child td{border-bottom:none;}
.table-input{width:100%;border:none;background:transparent;text-align:center;}
.table-input:disabled{background-color:#f1f5f9;color:#cbd5e1;}
.table-input:not(:disabled):focus{outline:none;background:rgba(0,51,102,0.05);}
.undertaking-box{border:1px solid #e2e8f0;padding:25px;margin-top:40px;background:#f8fafc;border-radius:8px;}
.undertaking-box h5{border-bottom:1px solid #cbd5e1;padding-bottom:10px;margin-bottom:15px;font-weight:700;color:#003366;}
.signatures{display:flex;justify-content:space-between;margin-top:50px;gap:20px;}
.sig-box{width:45%;}
.sig-box p{margin:0 0 8px 0;font-size:0.9rem;font-weight:600;color:#475569;}
.underline-input{border:none;border-bottom:2px solid #334155;width:100%;padding:5px 0;font-family:'Brush Script MT', cursive;font-size:1.5rem;text-align:center;}
.btn-submit{background:#003366;color:white;padding:14px 50px;border-radius:50px;font-weight:700;text-transform:uppercase;border:none;box-shadow:0 4px 10px rgba(0,51,102,0.2);transition:all 0.3s;}
.btn-submit:hover{background:#004080;transform:translateY(-2px);box-shadow:0 6px 15px rgba(0,51,102,0.3);}
.btn-success{background:#10b981 !important;box-shadow:0 4px 10px rgba(16,185,129,0.2);}
.paper-footer{text-align:center;font-size:0.85rem;color:#64748b;margin-top:50px;border-top:1px solid #eee;padding-top:20px;}
@media(max-width:768px){.paper-card{padding:25px 15px;}.photo-upload-box{height:150px;}.signatures{flex-direction:column;gap:30px;}.sig-box{width:100%;}.table-responsive{display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;}.paper-table{width:100%;min-width:600px;}}
</style>
</head>
<body>

<nav class="navbar navbar-expand-lg fixed-top navbar-light">
  <div class="container">
    <a class="navbar-brand" href="#">
      <img src="favicon.png" alt="Unified" height="40">
      <span class="brand-text">Joining Form</span>
    </a>
  </div>
</nav>

<div class="main-wrapper">
  <div class="container">
    <div class="paper-card">
      <div class="paper-header">
        <h2>UNIFIED SECURITY AND FACILITIES MANAGEMENT SERVICES PVT. LTD.</h2>
        <h5>Joining / General Information Form</h5>
        <p class="asterisk">*All details should be as per Aadhaar Card</p>
      </div>

      <form id="joiningForm">
        <div id="statusMsg" class="alert d-none"></div>

        <!-- PHOTO -->
        <label class="form-label-bold">Employee Photo</label>
        <div class="photo-upload-box">
          <div class="photo-placeholder" onclick="document.getElementById('photoInput').click()">
            <i class="fas fa-camera fa-2x"></i>
            <p>Click to Upload</p>
          </div>
          <input type="file" id="photoInput" name="photo" accept="image/*" class="d-none">
        </div>

        <!-- BASIC DETAILS -->
        <div class="row mt-4">
          <div class="col-md-6"><label class="form-label-bold">Full Name</label><input type="text" name="fullName" class="paper-input" required></div>
          <div class="col-md-6"><label class="form-label-bold">UAN Number</label><input type="text" name="uanNumber" class="paper-input" required></div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6"><label class="form-label-bold">Work Location</label><input type="text" name="workLocation" class="paper-input" required></div>
          <div class="col-md-6"><label class="form-label-bold">Designation</label><input type="text" name="designation" class="paper-input" required></div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6"><label class="form-label-bold">Gender</label><input type="text" name="gender" class="paper-input" required></div>
          <div class="col-md-6"><label class="form-label-bold">Date of Birth</label><input type="date" name="dob" class="paper-input" required></div>
        </div>

        <!-- NOMINEE -->
        <div class="row mt-3">
          <div class="col-md-6"><label class="form-label-bold">Father/Husband Name</label><input type="text" name="fatherName" class="paper-input" required></div>
          <div class="col-md-6"><label class="form-label-bold">Nominee Name</label><input type="text" name="nomineeName" class="paper-input"></div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6"><label class="form-label-bold">Nominee Relation</label><input type="text" name="nomineeRelation" class="paper-input"></div>
          <div class="col-md-6"><label class="form-label-bold">Joining Date</label><input type="date" name="joiningDate" class="paper-input" required></div>
        </div>

        <!-- CONTACT & BANK -->
        <div class="row mt-3">
          <div class="col-md-6"><label class="form-label-bold">Marital Status</label><input type="text" name="maritalStatus" class="paper-input"></div>
          <div class="col-md-6"><label class="form-label-bold">Mobile Number</label><input type="tel" name="mobileNumber" class="paper-input" required></div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6"><label class="form-label-bold">Aadhaar Number</label><input type="text" name="aadhaarNumber" class="paper-input"></div>
          <div class="col-md-6"><label class="form-label-bold">PAN Number</label><input type="text" name="panNumber" class="paper-input"></div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6"><label class="form-label-bold">Bank Account Number</label><input type="text" name="bankAccount" class="paper-input"></div>
          <div class="col-md-6"><label class="form-label-bold">IFSC Code</label><input type="text" name="ifscCode" class="paper-input"></div>
        </div>

        <!-- DOCUMENTS -->
        <div class="row mt-4">
          <div class="col-md-4">
            <label class="form-label-bold">Upload Aadhaar</label>
            <input type="file" id="aadhaarFile" class="form-control" accept=".pdf,image/*">
          </div>
          <div class="col-md-4">
            <label class="form-label-bold">Upload PAN</label>
            <input type="file" id="panFile" class="form-control" accept=".pdf,image/*">
          </div>
          <div class="col-md-4">
            <label class="form-label-bold">Upload Bank Document</label>
            <input type="file" id="bankFile" class="form-control" accept=".pdf,image/*">
          </div>
        </div>

        <!-- ADDRESS -->
        <div class="row mt-3">
          <div class="col-md-6"><label class="form-label-bold">Present Address</label><textarea name="presentAddress" class="paper-textarea"></textarea></div>
          <div class="col-md-6"><label class="form-label-bold">Permanent Address</label><textarea name="permanentAddress" class="paper-textarea"></textarea></div>
        </div>

        <!-- ESIC TABLE -->
        <div class="table-responsive mt-4">
          <label class="form-label-bold">ESIC Details</label>
          <table class="paper-table" id="esicTable">
            <thead>
              <tr>
                <th>ESIC Number</th>
                <th>Name</th>
                <th>Relation</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><input type="text" class="table-input" name="esicNumber"></td>
                <td><input type="text" class="table-input" name="esicName"></td>
                <td><input type="text" class="table-input" name="esicRelation"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="text-center mt-4">
          <button type="submit" id="submitBtn" class="btn btn-submit"><i class="fas fa-check-double me-2"></i> Submit Form</button>
        </div>

      </form>

      <div class="paper-footer">
        <p>Shop No.09, Hari Singh Market, Opp DLF Arbour, Sec-63, Gurugram Haryana India- 122003</p>
        <p>Email: info@unifiedfacility.in</p>
      </div>
    </div>
  </div>
</div>

<script>
const SCRIPT_URL='https://script.google.com/macros/s/AKfycbyBaFQIr9PtvIsIM3f10EAFOqeM9JCuvjyMGlcdlKFBVLI6lmCcMlhjpfBXbF7KAF-e/exec';
let employeeCounter = 261;

// Convert file input to Base64
async function fileToBase64(inputId) {
  const file = document.getElementById(inputId).files[0];
  if(!file) return '';
  return new Promise(resolve => {
    const reader = new FileReader();
    reader.onload = e => resolve(e.target.result);
    reader.readAsDataURL(file);
  });
}

// Photo preview
document.getElementById('photoInput').addEventListener('change', async function(){
  const file = this.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = e => {
      document.querySelector('.photo-placeholder').innerHTML = `<img src="${e.target.result}" style="width:100%; height:100%; object-fit:cover; border-radius:8px;">`;
    };
    reader.readAsDataURL(file);
  }
});

// Submit Form
document.getElementById('joiningForm').addEventListener('submit', async function(e){
  e.preventDefault();
  const btn = document.getElementById('submitBtn');
  const msg = document.getElementById('statusMsg');
  btn.disabled = true;
  btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Submitting...';
  msg.classList.add('d-none');

  const formData = new FormData(this);
  const data = {};
  formData.forEach((value,key) => data[key] = value);

  data.empId = `UFD-HR-S-${employeeCounter.toString().padStart(5,'0')}`;
  employeeCounter++;

  // Convert files to Base64
  data.photo = await fileToBase64('photoInput');
  data.aadhaarFile = await fileToBase64('aadhaarFile');
  data.panFile = await fileToBase64('panFile');
  data.bankFile = await fileToBase64('bankFile');

  // Gather ESIC table data
  const esicRows = document.querySelectorAll('#esicTable tbody tr');
  data.esicDetails = Array.from(esicRows).map(r => ({
      number: r.querySelector('[name="esicNumber"]').value,
      name: r.querySelector('[name="esicName"]').value,
      relation: r.querySelector('[name="esicRelation"]').value
  }));

  try{
    await fetch(SCRIPT_URL, {
      method:'POST',
      body: JSON.stringify(data),
      headers:{'Content-Type':'application/json'}
    });
    msg.className='alert alert-success';
    msg.innerHTML = `<strong>Form Submitted!</strong><br>Employee ID: ${data.empId}`;
    msg.classList.remove('d-none');
    this.reset();
    document.querySelector('.photo-placeholder').innerHTML = `<i class="fas fa-camera fa-2x"></i><p>Click to Upload</p>`;
    btn.innerHTML='<i class="fas fa-check me-2"></i> Submitted';
    btn.classList.add('btn-success');
    btn.disabled=false;
  }catch(err){
    console.error(err);
    msg.className='alert alert-danger';
    msg.innerText='Error submitting form! Please try again.';
    msg.classList.remove('d-none');
    btn.innerHTML='Submit Form';
    btn.disabled=false;
  }
});
</script>

</body>
</html>
