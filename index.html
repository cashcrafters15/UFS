<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>UFD Employee Joining Form</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>

<body>

<div class="container mt-5">
  <h2 class="text-center mb-4">Employee Joining Form</h2>

  <div id="msg" class="alert d-none"></div>

  <form id="joiningForm">
    <input type="text" name="fullName" class="form-control mb-2" placeholder="Full Name" required>
    <input type="text" name="mobile" class="form-control mb-2" placeholder="Mobile (10 digit)" required>
    <input type="text" name="workLocation" class="form-control mb-2" placeholder="Work Location" required>
    <input type="text" name="designation" class="form-control mb-2" placeholder="Designation" required>

    <label>Photo</label>
    <input type="file" id="photo" accept="image/*" required class="form-control mb-2">

    <label>Aadhaar Front</label>
    <input type="file" id="doc1" accept="image/*" required class="form-control mb-2">

    <label>Aadhaar Back</label>
    <input type="file" id="doc2" accept="image/*" required class="form-control mb-2">

    <label>PAN</label>
    <input type="file" id="doc3" accept="image/*" required class="form-control mb-2">

    <label>Bank Proof</label>
    <input type="file" id="doc4" accept="image/*,.pdf" required class="form-control mb-3">

    <button class="btn btn-primary w-100" id="submitBtn">Submit</button>
  </form>
</div>

<script>
const SCRIPT_URL = "PASTE_YOUR_NEW_WEB_APP_URL";

document.getElementById("joiningForm").addEventListener("submit", async e => {
  e.preventDefault();

  const msg = document.getElementById("msg");
  const btn = document.getElementById("submitBtn");

  msg.className = "alert alert-info";
  msg.innerText = "Submitting...";
  msg.classList.remove("d-none");
  btn.disabled = true;

  try {
    const data = {
      action: "submitForm",
      fullName: joiningForm.fullName.value,
      mobile: joiningForm.mobile.value,
      workLocation: joiningForm.workLocation.value,
      designation: joiningForm.designation.value
    };

    data.photoBase64 = await toBase64(photo.files[0]);
    data.doc1Base64 = await toBase64(doc1.files[0]);
    data.doc2Base64 = await toBase64(doc2.files[0]);
    data.doc3Base64 = await toBase64(doc3.files[0]);
    data.doc4Base64 = await toBase64(doc4.files[0]);

    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    const json = await res.json();

    if (json.status !== "success") throw json.message;

    msg.className = "alert alert-success";
    msg.innerHTML = `Form submitted.<br>Employee ID: <b>${json.employeeId}</b>`;
    joiningForm.reset();

  } catch (err) {
    msg.className = "alert alert-danger";
    msg.innerText = err;
  }

  btn.disabled = false;
});

function toBase64(file) {
  return new Promise((res, rej) => {
    const r = new FileReader();
    r.onload = () => res(r.result);
    r.onerror = rej;
    r.readAsDataURL(file);
  });
}
</script>

</body>
</html>
